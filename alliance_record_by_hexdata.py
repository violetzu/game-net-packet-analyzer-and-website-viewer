hex_data='43:06:00:00:00:1f:8b:08:00:00:00:00:00:04:00:55:56:7b:4c:53:57:18:3f:f7:16:a6:f8:66:99:d1:8d:6d:59:3c:8b:2e:d3:3f:da:52:4a:99:ba:87:20:a4:01:8a:02:22:be:e6:6e:e1:aa:0d:d0:ce:b6:08:75:71:02:15:c1:f2:54:b1:80:e2:04:ac:50:36:c6:ab:0e:ab:20:cc:69:b6:64:cb:fe:c0:89:d9:74:d9:23:ed:bd:2d:ba:44:23:b8:b0:44:b7:9d:73:ef:ed:ed:e5:e4:34:a7:df:c9:ef:9e:fb:fb:be:ef:f7:7d:e7:de:8d:02:20:06:00:90:95:98:66:da:6f:c8:db:9b:42:5b:b7:19:0d:26:63:3a:ad:d7:1a:f7:99:36:51:79:05:bf:df:23:00:81:20:1a:f4:5b:bb:41:06:d0:13:60:11:fa:29:35:d0:3f:ea:f0:5f:ad:09:d4:7e:de:8d:6c:d3:ec:c2:88:02:1d:00:ce:15:80:c3:7f:b4:55:06:e6:a3:35:8a:c7:06:06:3d:6c:cd:09:0f:32:66:ff:78:bc:e8:43:04:6c:15:80:bf:f4:c9:c0:3c:01:18:1b:0f:a7:ce:b9:99:9e:2b:9f:20:e3:e1:81:ff:40:0e:02:5a:11:10:0f:77:61:24:f7:c0:52:cc:46:01:d9:ce:72:c6:5b:cd:b8:5b:b2:74:a9:9f:a2:ad:7b:8f:de:23:d4:80:87:63:58:af:55:02:57:42:b6:b7:3b:70:b6:8a:f5:74:06:4f:b5:62:f8:82:77:d5:73:e0:ed:2f:f0:70:ec:5b:bc:02:d1:a8:64:2a:bd:8c:bb:ed:18:b2:b3:e5:1e:62:1d:5a:2d:02:76:66:67:f8:e8:f8:04:c8:5c:1d:61:3b:bb:d8:96:0b:81:9e:6b:76:b4:f5:da:af:37:88:6c:5d:18:3e:e1:8e:e0:56:ec:a5:5a:05:73:73:b5:19:75:e8:ef:d3:65:01:72:58:43:80:26:01:b6:a1:90:87:e1:40:c4:69:60:56:c6:b6:b4:4d:59:95:c8:f8:cb:9d:41:4e:ee:25:44:aa:33:0d:91:22:50:a3:82:ac:dd:13:ac:6e:2a:46:86:73:f1:5b:78:5f:04:26:e6:cd:e1:39:55:7e:3a:d8:5d:ce:36:b7:33:dd:35:15:68:eb:fc:f7:4e:e2:50:1b:00:66:01:fe:6a:23:4f:60:31:e6:a9:84:49:26:b3:c1:92:62:a6:8c:d6:5a:b4:71:7a:f2:28:99:8a:d6:12:01:fc:fc:81:4c:8c:97:4a:05:b3:cd:26:9b:ce:54:48:19:71:6c:97:4f:fc:08:5e:96:c4:eb:49:c1:9c:cc:05:2b:3a:82:c3:1e:76:c0:cb:8c:da:31:8f:df:46:6f:10:3a:3e:c7:1c:6c:fb:aa:08:f1:e8:38:39:4c:33:15:1b:2c:5b:28:2b:7d:02:d9:c1:89:21:f2:48:9b:24:cb:1a:9e:46:34:96:59:3c:cc:b2:9a:a9:12:3d:6d:36:db:12:a9:02:ba:1a:6d:6e:ec:76:11:23:d1:04:68:14:1e:d0:97:48:82:a7:84:c1:ba:8b:c1:b2:32:9c:e4:0a:f7:7d:e2:30:8a:62:83:00:34:ea:23:44:d2:28:1d:c1:f1:2b:68:06:3c:0e:34:71:3c:6e:bd:72:91:74:a1:73:43:f0:66:42:a2:1f:39:0c:9e:1f:66:cb:6b:82:8e:c1:e3:c8:1e:70:3d:25:f6:15:87:49:6f:be:1f:8e:47:82:02:32:b5:e3:4c:63:5d:a0:c9:cd:56:5f:c1:3e:ee:59:12:43:16:e9:c2:f0:49:1d:cf:64:01:66:12:07:b5:79:74:b2:c1:4c:e3:c8:81:6f:1a:89:2f:1e:00:50:2a:20:63:bb:25:81:56:43:d6:d9:1c:68:bf:cc:0e:79:fc:de:36:9c:97:3b:8e:8f:09:95:44:1f:39:5f:4b:62:81:6a:b4:b7:89:e9:74:1f:c1:6f:ca:a5:89:a5:92:8c:ac:5d:cd:03:97:a0:1f:aa:8d:91:93:81:b1:eb:e9:94:c5:4a:9b:31:df:da:09:1f:d1:15:1d:d6:67:8c:37:1c:0a:4d:3c:64:2e:5d:0f:5c:72:32:7d:cd:36:64:6b:f7:bc:49:14:4b:42:f1:53:89:4c:a4:a0:94:43:66:ac:8f:a9:3a:d1:8c:8c:8b:37:57:cb:f0:a1:21:0a:63:a5:7c:10:96:e1:20:a0:9a:ab:19:67:c6:5b:d8:ea:93:72:45:5c:6c:3d:da:4b:7e:b8:9e:c4:f8:83:c2:c1:c5:39:61:31:c7:a9:61:22:65:3d:60:db:62:b0:5a:2d:38:79:67:37:4f:12:c9:12:81:9e:fc:3b:52:04:2b:e4:48:a1:e3:3d:41:77:99:df:3b:8c:cb:ef:f6:22:86:2c:47:92:ab:15:c0:cf:8c:fc:c9:f3:b9:60:30:ae:9e:a9:32:2f:16:d0:cf:63:35:1c:83:50:32:b6:66:f3:ae:2d:e4:a5:b9:b9:a8:88:ca:34:59:a8:72:64:5e:b3:3c:06:a1:81:21:a1:26:8b:a1:71:30:d0:7a:9d:75:0f:b2:1d:f6:52:64:3e:3a:ba:1b:ec:45:62:38:2b:9c:ba:b2:35:1c:b0:58:15:44:9d:3b:2b:75:07:ce:c2:91:e5:ef:90:9b:25:c9:9d:39:13:6e:27:a8:9a:d3:0d:c6:fd:36:0a:f3:94:4d:ef:e0:da:49:a9:d0:57:73:48:49:0a:94:30:f5:83:5c:ad:56:8b:4f:7c:da:19:43:66:00:20:02:d7:3d:89:14:75:98:90:00:53:69:9b:42:a5:54:96:61:1f:66:35:e4:57:82:02:f0:98:b7:91:7f:f7:8b:d8:9f:58:18:a8:ef:41:93:19:68:98:ea:6a:65:bd:de:06:b4:7b:6a:77:2f:99:bc:86:af:36:3c:dc:bb:48:51:b9:0a:25:2f:31:07:d3:78:ce:ef:1d:39:83:b6:1e:de:66:09:88:d6:83:02:fc:d8:50:f8:05:a8:a5:06:c6:ea:99:d1:06:bf:b7:8e:71:b4:33:c7:07:70:d6:76:45:5f:20:e2:84:14:e3:b1:2a:5b:d2:54:d4:70:3b:6d:cc:b7:a5:9b:2c:16:8c:75:ae:38:3f:47:c0:6f:ac:97:d4:b2:1a:06:fa:ca:d0:0c:3a:ab:30:b6:e4:db:21:c2:25:71:75:f0:4e:b8:86:12:e4:30:a5:d0:64:2a:b2:59:91:91:a2:eb:05:b8:bb:86:28:5f:fe:81:27:f0:02:9f:8f:a4:c3:05:b8:35:d8:bd:bb:49:bb:a4:9f:45:0d:46:88:4a:40:8e:ed:c4:23:29:37:09:e7:ad:72:f0:16:77:63:85:3c:5a:53:23:29:33:15:cc:a4:e9:fc:24:33:ea:7a:87:90:3d:9d:b8:92:bb:b1:42:02:23:84:66:f6:3a:e0:9a:99:cf:de:e1:ab:f0:fa:ec:5f:fa:ec:9f:f9:ec:76:5f:45:bf:af:c2:e5:b3:8f:fa:ec:1e:9c:9c:ec:3e:8a:eb:f5:66:e1:4d:2f:09:f7:08:56:bc:46:8e:12:6f:2e:dc:81:65:1c:ff:6f:12:91:01:c2:37:f4:dd:4a:c9:45:27:87:05:36:93:b1:0a:1f:f3:cf:7e:4e:99:25:02:ac:7f:6e:7f:67:ea:9a:d9:96:7a:a6:61:a8:11:d9:1d:d3:6e:ae:ad:86:8a:e8:6a:72:b8:88:14:30:25:45:ab:d3:ea:f2:69:33:2e:e2:b7:bb:6e:10:72:41:13:18:d2:21:97:89:f2:44:f5:96:46:1d:b6:25:51:b6:53:c8:7a:3f:73:96:c4:77:40:b1:80:7c:3c:1d:6e:ed:ea:04:98:69:c8:3b:40:99:f3:53:0c:7a:bd:e5:28:ce:d4:a5:26:ae:ab:86:dc:ba:a5:97:b4:12:0d:4c:a1:f4:7a:5b:26:6d:a3:2d:b8:05:3b:ab:9e:81:02:c9:57:8a:eb:4f:49:56:12:a0:ff:5a:2d:db:df:e4:f7:96:e1:5a:de:38:d3:c9:7d:d1:84:24:b1:ec:81:a4:44:d1:15:e3:70:a0:89:0f:9d:be:f9:9c:13:6f:28:62:f2:41:99:28:77:f1:1b:29:d0:5d:ce:f4:1f:67:5c:c7:30:e7:ef:a2:0c:a2:84:f1:f8:1f:18:e9:c2:40:da:09:00:00'
hex_data=hex_data.replace(":", "")

# alliance_name = "迷人又可爱的"
# alliance_name = "可爱又迷人的"
alliance_name = "玉子烧的小屋"

import gzip
from general import read_json, write_json

def decode_data(hex_data):
    """解碼二進制數據並提取成員信息。"""
    decompressed_data = gzip.decompress(bytes.fromhex(hex_data[10:]))
    # print(decompressed_data)
    result = decompressed_data.split(b'\x00')
    result = [item for item in result if item != b'']
    alliance_member = []
    for data in result:
        if len(data) > 1 and b'\x23' in data:
            try:
                utf8_data = data[:-1].decode('utf-8').split('#')
                server = int(utf8_data[0])
                member = f'#{server if server > 9 else f"0{server}"} {utf8_data[1]}'
                alliance_member.append(member)
            except (UnicodeDecodeError, ValueError) as e:
                print(e)
                pass
    return alliance_member

def update_alliance(alliance_name, new_members):
    """更新公會成員名單。"""
    alliance = read_json('alliance.json')
    old_members = alliance.get(alliance_name, [])
    leave = [m for m in old_members if m not in new_members]
    join = [m for m in new_members if m not in old_members]
    alliance[alliance_name] = new_members
    return alliance, join, leave

alliance_member = decode_data(hex_data)
while True:
    alliance, join, leave = update_alliance(alliance_name, alliance_member)
    print(f"加入的成員: {join}")
    print(f"離開的成員: {leave}")

    
    check = input('是否儲存(Y):').strip().upper()
    if check == 'Y':
        write_json('alliance.json', alliance)
        break
    elif check == 'N':
        continue